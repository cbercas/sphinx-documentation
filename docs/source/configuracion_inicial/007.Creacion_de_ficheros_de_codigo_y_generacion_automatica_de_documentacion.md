# **Creaci贸n de ficheros de c贸digo y generaci贸n autom谩tica de documentaci贸n**

## 1. Creaci贸n del fichero de c贸digo Python

Se crea un fichero de c贸digo Python con **docstring en formato Google Style**. Este formato facilita la generaci贸n autom谩tica de documentaci贸n, ya que utiliza una estructura clara y legible tanto para humanos como para herramientas de generaci贸n de documentaci贸n.  

```{literalinclude} ../../../src/math_operations.py
:language: python
:linenos:
```

Explicaci贸n del formato Google Style:
- Args: Define los argumentos que la funci贸n recibe, indicando su nombre, tipo y prop贸sito.
- Returns: Describe lo que devuelve la funci贸n, incluyendo el tipo de dato.
- Raises(opcional): Especifica las excepciones que la funci贸n podr铆a lanzar.

Este formato garantiza que la documentaci贸n sea clara y estandarizada.

### 1.2. Pasos para generar la documentaci贸n autom谩ticamente

1.  **Instalaci贸n de Sphinx**:  
    Hay que asegurarse de tener Sphinx instalado en el entorno de trabajo. Si no, hay que instalarlo con:
    
    ```bash
    pip install sphinx
    
    ```

2.  **Activaci贸n entorno virtual**:  
    Hay que asegurarse de tener activado el entorno virtual en el entorno de trabajo. Si no, hay que activarlo con:
    
    ```bash
    env\Scripts\activate
    
    ```    
    
3.  **Ejecuci贸n de sphinx-apidoc**:  

    `sphinx-apidoc` es una herramienta de l铆nea de comandos incluida en Sphinx que genera autom谩ticamente archivos de documentaci贸n para m贸dulos y paquetes Python. 
    Su prop贸sito principal es agilizar el proceso de creaci贸n de documentaci贸n basada en docstrings, generando archivos de entrada para Sphinx a partir de la estructura del c贸digo fuente.
    Esta herramienta es especialmente 煤til en proyectos grandes con m煤ltiples m贸dulos y paquetes, ya que automatiza la creaci贸n de archivos de documentaci贸n necesarios para cada m贸dulo, en el formato configurado (por ejemplo, .rst, .md o cualquier otro formato compatible).
        
    ```bash
    sphinx-apidoc -o .\source\ ../src --separate 
    
    ```
    
    -   **`-o .\source\`**: Indica la carpeta donde se generar谩n los archivos de documentaci贸n.
    -   **`../src`**: Especifica el directorio donde se encuentran los archivos de c贸digo Python.
    -   **`--separate`**: Genera un archivo separado para cada m贸dulo detectado en lugar de consolidar toda la documentaci贸n en un 煤nico archivo.

    Al ejecutar el comando sphinx-apidoc, en nuestro caso los archivos generados son:
    - math_operations.rst
    - modules.rst

 **Ejemplo de archivos creados:**

 ![archivos generada](../_static/images/directorio_math_rst.png)

4.  **Compilaci贸n de la documentaci贸n**:  
    Una vez se tengan los archivos generados, hay que compilar la documentaci贸n usando:

    - Hay que navegar al directorio de documentaci贸n (`docs/`):
    
    ```bash    
    cd docs
    ```
    
    - Luego hay que ejecutar el siguiente comando para generar la documentaci贸n HTML:
    
    ```bash
    make.bat html  
    ```
    
    Esto crear谩 una carpeta `docs/build/html/` con los archivos HTML de la documentaci贸n generada.

 **Ejemplo de html creados:**

 ![html generado](../_static/images/archivosHtml.png)

**Enlace directo a la documentaci贸n HTML**:  

 <a href="../../html/math_operations.html" target="_blank">Ver la documentaci贸n del m贸dulo html math_operations</a>

----------

## 2. Resultados obtenidos

Cuando ejecutas el comando `sphinx-apidoc`, se generan una serie de archivos en el directorio `docs/source` que contienen la estructura b谩sica de la documentaci贸n para el proyecto. Este comando facilita la generaci贸n autom谩tica de documentaci贸n a partir del c贸digo fuente, especialmente de los docstrings de los m贸dulos y clases Python.

### 2.1. **Estructura de Archivos Generada**

Al ejecutar `sphinx-apidoc -o docs/source src/`, se crear谩 una serie de archivos en la carpeta `docs/source`:

#### a. **Archivos `.rst` para cada m贸dulo Python**

Cada m贸dulo de Python dentro de la carpeta `src/` tendr谩 un archivo generado. Nuestro proyecto tiene el m贸dulo 
 `math_operations.py`, se genera el archivo:

-   `math_operations.rst`

Este archivo contienen la documentaci贸n generada a partir de los docstrings de los m贸dulos. Por ejemplo, si tu m贸dulo `math_operations.py` tiene funciones con docstrings, el archivo generado incluir谩 lo siguiente:

```
math\_operations module
=======================

.. automodule:: math_operations
   :members:
   :undoc-members:
   :show-inheritance:

```

Este archivo generado tiene varias secciones importantes:

-   **`automodule:: math_operations`**: Esto indica que Sphinx debe generar la documentaci贸n autom谩ticamente para el m贸dulo `math_operations`.
-   **`:members:`**: Esto genera la documentaci贸n para todas las funciones y clases dentro del m贸dulo.
-   **`:undoc-members:`**: Si hay funciones o clases sin docstrings, esta directiva las incluir谩 en la documentaci贸n.
-   **`:show-inheritance:`**: Si hay clases, muestra tambi茅n la jerarqu铆a de herencia.

Este es el formato que Sphinx usa para incluir la documentaci贸n del c贸digo fuente, asegur谩ndose de que los cambios en los archivos de c贸digo fuente se reflejen autom谩ticamente en la documentaci贸n.

#### b. **`modules.rst` **

Este archivo lista todos los m贸dulos generados, lo cual es 煤til si hay muchos m贸dulos en el proyecto. Por ejemplo:

```
src
===

.. toctree::
   :maxdepth: 4

   math_operations


```

Este archivo crea un 铆ndice de m贸dulos que Sphinx incluir谩 en la documentaci贸n final.

### 2.2. **Contenido de los Archivos Generados**

#### a. **Documentaci贸n Generada Autom谩ticamente desde el C贸digo**

El objetivo principal de `sphinx-apidoc` es generar documentaci贸n autom谩ticamente a partir de los docstrings en el c贸digo Python. Para cada archivo `.py` que contiene docstrings, se generar谩 una representaci贸n en reStructuredText.

Por ejemplo, nuestro archivo `math_operations.py` con el siguiente c贸digo:

```python
def add_numbers(a, b):
    """Suma dos n煤meros."""
    return a + b

```

El archivo `math_operations.rst` generado tendr谩 algo similar a esto:

```rst
math\_operations module
=======================

.. automodule:: math_operations
   :members:
   :undoc-members:
   :show-inheritance:

```

La directiva `automodule` incluye el m贸dulo completo, y las funciones o clases del m贸dulo se detallan debajo con sus respectivas descripciones.

#### b. **Incluir Todo el C贸digo del Proyecto**

Los archivos generados tambi茅n incluyen c贸digo fuente si usamos la extensi贸n `viewcode` en el archivo `conf.py` de Sphinx. Esto agrega enlaces al c贸digo fuente y puede incluir la visualizaci贸n completa del c贸digo si se activa la opci贸n correspondiente.

#### c. **Dependencias de M贸dulos**

Si el proyecto tiene dependencias de otros m贸dulos dentro de `src/`, el sistema de documentaci贸n puede generar autom谩ticamente enlaces a esos m贸dulos y sus funciones.

### 2.3. **Uso de los Archivos Generados**

Una vez que `sphinx-apidoc` ha generado estos archivos, puedes:

-   **Editar manualmente** el archivo `index.rst` o `index.md` para personalizar la estructura de la documentaci贸n.
-   **Incluir o excluir m贸dulos** de la documentaci贸n generada editando los archivos `.rst` o `.md` generados.
-   **Ejecutar `sphinx-build`** para generar la documentaci贸n final en formato HTML, PDF, etc.

Por ejemplo, se puede generar la documentaci贸n HTML con el siguiente comando:

```bash
sphinx-build -b html source build

```

Esto generar谩 una carpeta `build` que contendr谩 la documentaci贸n final en formato HTML. Se pueden abrir estos archivos en el navegador para visualizar la documentaci贸n generada.

### 2.4. **Personalizaci贸n de la Documentaci贸n Generada**

Aunque los archivos generados por `sphinx-apidoc` contienen una buena base de documentaci贸n, se pueden personalizar a煤n m谩s, por ejemplo:

-   **Agregar enlaces y referencias**: Se puede usar `:ref:` y `:doc:` para vincular otros documentos generados por Sphinx.
-   **Agregar secciones adicionales**: Se puede agregar m谩s texto explicativo o personalizar la apariencia con archivos CSS o HTML.

## 3. Conclusiones

-   **Automatizaci贸n**: El uso de `sphinx-apidoc` simplifica la generaci贸n de documentaci贸n a partir de c贸digo Python, ahorrando tiempo y esfuerzo.
-   **Legibilidad**: El uso de docstring en formato Google Style mejora la claridad y consistencia de la documentaci贸n.
-   **Compatibilidad**: Los archivos `.rst` generados por Sphinx son f谩cilmente convertibles a otros formatos, como `.md`, para adaptarse a distintas necesidades de publicaci贸n.

Esta metodolog铆a no solo mejora la calidad de la documentaci贸n, sino que tambi茅n reduce el tiempo necesario para su mantenimiento y actualizaci贸n.